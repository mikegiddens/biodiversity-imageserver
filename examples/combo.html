<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Example</title>

	 <style>
            .thumbnail {
            	padding: 4px;
            	background-color: #e6e6e0;
            	border: 1px solid #d6d6d0;
            	float: left;
            	margin-right: 20px;
            	margin-bottom: 20px;
        	}
			#combo-carousel {
				padding: 5px;
				height: 240px;
				width: 358px;
				background-color: #E6E6E0;
				margin-top: 20px;
				overflow: hidden;
			}

			#combo-carousel p {
				padding: 20px;
			}

			
			div.item {
				padding: 20px;
			}

						
    </style>
	<!-- ** All BAse ** -->
<link rel="stylesheet" type="text/css" href="http://images.cyberfloralouisiana.com/portal/resources/css/ext-all.css">
	<script type="text/javascript" src="http://images.cyberfloralouisiana.com/portal/resources/ext/ext-base.js"></script>
	<script type="text/javascript" src="http://images.cyberfloralouisiana.com/portal/resources/ext/ext-all.js"></script>
	
    <!-- ** CSS ** -->

    	<link href="http://images.cyberfloralouisiana.com/portal/examples/combo/carousel.css" rel="stylesheet">
         <link href="http://images.cyberfloralouisiana.com/portal/examples/combo/lightbox.css" rel="stylesheet">
		<link href="http://images.cyberfloralouisiana.com/portal/examples/combo/examples.css" rel="stylesheet">
        
		<!-- ** JS ** -->
    	<script src="http://images.cyberfloralouisiana.com/portal/examples/combo/ext-core-debug.js"></script>
        <script src="http://images.cyberfloralouisiana.com/portal/examples/combo/carousel.js"></script>
        <script src="http://images.cyberfloralouisiana.com/portal/examples/combo/lightbox.js"></script>
        <script src="http://images.cyberfloralouisiana.com/portal/examples/combo/jsonp.js"></script>
	

	<!-- overrides to base library -->	
	<link rel="stylesheet" type="text/css" href="http://images.cyberfloralouisiana.com/portal/resources/css/style.css" />
	<link rel="stylesheet" type="text/css" href="http://images.cyberfloralouisiana.com/portal/resources/css/tpl.css" />   
	
	
	
	<script>
			Ext.ux.Lightbox.register('a[rel^=lightbox]');
			Ext.ux.Lightbox.register('a.lb-flower', true); // true to show them as a set
	</script> 
	
</head>
<body >
	<div id= "imagepanel" ></div>
		
		
		<script>
            Ext.ux.ComboExample = {
                init: function() {
                    this.photoTemplate = new Ext.Template([
                        '<a href="{path}{barcode}_m.jpg" class="lightbox" title="{title}">',
                            '<img src="{path}{barcode}_s.jpg" height="240">',
                        '</a>'
                    ]);

                    this.loadPhotos();
					//this.on('click', this.loadPhotos, this);
                    this.carousel = new Ext.ux.Carousel('combo-carousel', {
                        interval: 5,
                        itemSelector: 'a.lightbox',
                        showPlayButton: true,
                        pauseOnNavigate: true    
                    });
                    
                    Ext.ux.Lightbox.register('a.lightbox', true);
                    
                    Ext.ux.Lightbox.on('open', function() {
                        this.carousel.pause();
                    }, this);
                    
                    Ext.ux.Lightbox.on('close', function(image) {
                        this.carousel.setSlide(image);
                        this.carousel.play();
                    }, this);  
						
				},
                
               loadPhotos: function() {
					Ext.ux.JSONP.request('http://images.cyberfloralouisiana.com/portal/resources/api/api.php', {
                        callbackKey: 'jsoncallback',
                        params: {
                            format: 'json',
                          	cmd: 'images',
							filters:'',
							code:''
                        },
                        callback: this.updatePhotos,
                        scope: this
                    });
                },
              
                updatePhotos: function(data) {
                    Ext.select('#combo-carousel > p').remove();
                    
                    this.carousel.clear();
                    Ext.each(data.items, function(item) {
                        item.src = item.media.m;
                        item.href = item.media.m.replace('_s.jpg', '.jpg');
                        this.carousel.add(this.photoTemplate.append('combo-carousel', item));
                    }, this);
                    
                    this.carousel.refresh().play();
                }
            };
            
            Ext.onReady(Ext.ux.ComboExample.init, Ext.ux.ComboExample);
        </script>
		<div id="combo-carousel"></div> 
</body>
</html>